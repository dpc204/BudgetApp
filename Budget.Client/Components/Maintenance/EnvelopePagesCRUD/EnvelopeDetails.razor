@using Budget.Shared.Models
@using Budget.Shared.Services
@inject IBudgetMaintApiClient MaintApi

<MudDialog>
  <DialogContent>
    @if (_envelope is null)
    {
        <MudProgressCircular Indeterminate="true" />
    }
    else
    {
        <MudStack Spacing="1">
            <MudText Typo="Typo.h6">Envelope Details</MudText>
            <MudDivider Class="mb-2" />
            <MudText><strong>CategoryId:</strong> @_envelope.CategoryId</MudText>
            <MudText><strong>Name:</strong> @_envelope.Name</MudText>
            <MudText><strong>Budget:</strong> @_envelope.Budget</MudText>
            <MudText><strong>Balance:</strong> @_envelope.Balance</MudText>
            <MudText><strong>Description:</strong> @_envelope.Description</MudText>
            <MudText><strong>Sort:</strong> @_envelope.SortOrder</MudText>
        </MudStack>
    }
  </DialogContent>
  <DialogActions>
      <MudButton Variant="Variant.Text" Color="Color.Primary" OnClick="Close">Close</MudButton>
  </DialogActions>
</MudDialog>

@code {
    [Parameter] public int Id { get; set; }
    [CascadingParameter] private IMudDialogInstance MudDialog { get; set; } = default!;

    private EnvelopeDto? _envelope;

    protected override async Task OnParametersSetAsync()
    {
        var list = await MaintApi.GetEnvelopesDtoAsync();
        _envelope = list.FirstOrDefault(e => e.Id == Id);
    }

    private void Close() => MudDialog.Close();
}
